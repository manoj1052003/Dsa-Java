package com.DLinkedList;

class Node {
	int data;
	Node next;
	Node prev;

	Node(int data) {
		this.data = data;
		this.next = null;
		this.prev = null;
	}
}

class DLL {

	Node head;
	Node tail;

	public void add_first(int ele) {
		Node temp = new Node(ele);
		if (head == null) {
			head = temp;
			tail = temp;
		} else {
			temp.next = head;
			head.prev = temp;
			head = temp;
		}
	}

	public void add_last(int ele) {
		Node temp = new Node(ele);
		if (head == null) {
			head = temp;
			tail = temp;
		} else {
//			Node curr = head;
//			while(curr.next != null) {
//				curr = curr.next;
//			}
//			curr.next = temp;
//			temp.prev = curr;
			// why TF we using head here insted of tail
			tail.next = temp;
			temp.prev = tail;
			tail = temp;
		}
	}

	public int size() {
		int count = 0;
		Node curr = head;
		while (curr != null) {
			count++;
			curr = curr.next;
		}
		return count;
	}

	public void add_at(int index, int ele) {
		if (index < 0 || index > size()) {
			System.out.println("Invalid index ðŸ˜¢");
			return;
		} else if (index == 0) {
			add_first(ele);
		} else if (index == size()) {
			add_last(ele);
		} else {
			int count = 0;
			Node curr = head;
			Node temp = new Node(ele);
			while (count != index - 1) {
				count++;
				curr = curr.next;
			}
			temp.next = curr.next;
			curr.next.prev = temp;
			curr.next = temp;
			temp.prev = curr;
		}
	}
	
	public void delete_first() {
		if(head == null) {
			System.out.println("ll is already empty ");
			return;
		}
		if(head.next == null) {
			head = null;
			tail = null;
		}
		else {
			Node curr = head;
			head = curr.next;
			head.prev = null;
		}
		
	}
	
	public void delete_last() {
		if(tail == null) {
			System.out.println("ll is already empty ");
			return;
		}
		if(tail.prev == null) {
			head = null;
			tail = null;
		}
		else {
			tail = tail.prev;
			tail.next = null;
		}
	}
	
	public void delete_at(int index) {
		if(index==0) {
			delete_first();
			return;
		}
		if(index==size()-1) {
			delete_last();
			return;
		}
		if(index < 0 || index>=size()) {
			System.out.println("index is out of range");
			System.out.println("give an valid index");
		}
		else {
			Node curr = head;
			int count = 0;
			while(count!=index-1) {
				count++;
				curr = curr.next;
						
			}
			curr = curr.next.next;
			curr.next.prev = curr;
		}
	}

	public void print_LL_front() {
		if (head == null) {
			System.out.println("ll is empty");
		} else {
			Node curr = head;
			while (curr != null) {
				System.out.println(curr.data);
				curr = curr.next;
			}
		}
	}

	public void print_LL_back() {
		if (tail == null) {
			System.out.println("ll is empty");
		} else {
			Node curr = tail;
			while (curr != null) {
				System.out.println(curr.data);
				curr = curr.prev;
			}
		}
	}

}

public class First {

	public static void main(String[] args) {
		DLL dll = new DLL();
		dll.add_last(10);
		dll.add_last(30);
		dll.add_last(40);
		dll.add_last(20);

		dll.print_LL_front();
		
		dll.delete_at(2);
		System.out.println();
		dll.print_LL_front();

	}

}
